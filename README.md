# ToolBox_cpp

個人用のC++による小物ツール

ライセンスは検討中．
License: under consideration.

## Tool list

1. rename2today
    ファイル名に含まれる日付を実行時当日に更新，もしくは，実行日の日付を追加したファイル名に変更する．
1. revision_up
    引数で与えられたファイルを，リビジョンアップした名前のファイルにコピーする．

-----

## rename2today

version: 0.1
updated on 2022/01/29

### 概要

引数で与えられたファイルのファイル名に含まれる日付文字列(※)を実行当日のものに更新する．
日付文字列がない場合は，ファイル名の先頭に追加する．
ファイルの右クリックメニューから実行することを想定.
フォルダには未対応．

### 仕様

* 与えられたファイルのファイル名に日付文字列が含まれていれば，実行時の日付に更新して差し替えた名前にファイル名を変更する．
* 与えられたファイルのファイル名に日付文字列が含まれてなければ，ファイル名の先頭にアンダーバーをはさんで追加する．(Ex: a.txt => 2022-01-01_a.txt)
* 変更しようとするファイル名のファイルがすでに存在する場合，リビジョンアップ処理(後述)を行って，衝突しないファイル名を求めた上でrenameする．
* フォルダ名には関与しない
* 日付文字列は現在のところ， 2020-01-29 などのハイフン区切りの文字列を認識する．（正規表現: `/((?:20)?[012][0-9])-(0\d|11|12)-(0[1-9]|[12]\d|30|31))/`)

### 特徴・制限事項

* 基本的にはファイルのD&Dやシェルのコンテキストメニューからの実行を想定．
* 複数ファイルには対応しない．実行時の引数は単一ファイルである必要がある．逆にファイル名にスペースが含まれている場合でも，ダブルクォーテーションで囲ってなくても動作するはず．
* ダブルクォーテーションでくくっての引数渡しには対応
* 画面表示類はまったくなし．Windowの作成はまったく行わない．コンソールもないので，誤動作の原因究明には現状デバッグ実行が必須．
* 内部では`std::wstring`で処理しており，SJISのダメ文字がファイル名にあっても大丈夫かもしれない．（未確認）
* フォルダは判定すらしていない．

-----

## revision_up

version: 0.1
updated on 2022/01/29

### 概要

ファイル名の拡張子の直前のリビジョン番号を増やし，存在しないファイル名のファイルへとコピーする．

### リビジョンアップ処理

* リビジョンはbasenameの末尾にある _r1や_r23 などの数値 （basename(stem)に対する正規表現: `/_r\d+$/`)
* 候補のファイル名にリビジョン番号がない場合は，まず_r1をつけて確認する．
* 候補のファイル名にすでにリビジョン番号がある場合は，そのリビジョン番号を1増やして確認する．
* リビジョン番号を増やして確認してもその名前のファイルが存在した場合は，存在しなくなるまでリビジョンを増やしながら確認を続ける．
* 永久ループ対策で，999までで打ち切りにしている

### 特徴・制限事項

* 基本的にはファイルのD&Dやシェルのコンテキストメニューからの実行を想定．
* 複数ファイルには対応しない．実行時の引数は単一ファイルである必要がある．逆にファイル名にスペースが含まれている場合でも，ダブルクォーテーションで囲ってなくても動作するはず．
* ダブルクォーテーションでくくっての引数渡しには対応
* 画面表示類はまったくなし．Windowの作成はまったく行わない．コンソールもないので，誤動作の原因究明には現状デバッグ実行が必須．
* 内部では`std::wstring`で処理しており，SJISのダメ文字がファイル名にあっても大丈夫かもしれない．（未確認）
* フォルダには未対応

